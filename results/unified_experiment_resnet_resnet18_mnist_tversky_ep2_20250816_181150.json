{
  "timestamp": "20250816_181150",
  "config": {
    "model_type": "resnet",
    "experiment_name": "resnet_mnist_quick",
    "run_name": "resnet18_mnist_tversky_ep2",
    "epochs": 2,
    "learning_rate": 0.01,
    "batch_size": 64,
    "optimizer": "adam",
    "weight_decay": 0.0001,
    "scheduler": "cosine",
    "tversky": {
      "num_prototypes": 8,
      "alpha": 0.5,
      "beta": 0.5,
      "theta": 1e-07,
      "intersection_reduction": "product",
      "difference_reduction": "subtractmatch",
      "feature_bank_init": "xavier",
      "prototype_init": "xavier",
      "temperature": 1.0
    },
    "device": "auto",
    "checkpoint_dir": "./checkpoints",
    "results_dir": "./results",
    "mixed_precision": true,
    "seed": 42,
    "xor_config": null,
    "resnet_config": {
      "experiment_name": "tversky_resnet_mnist",
      "run_name": "resnet18_mnist_tversky_pretrained_unfrozen",
      "architecture": "resnet18",
      "pretrained": true,
      "frozen": false,
      "use_tversky": true,
      "dataset": "mnist",
      "data_dir": "./data",
      "batch_size": 64,
      "num_workers": 4,
      "epochs": 2,
      "learning_rate": 0.01,
      "weight_decay": 0.0001,
      "scheduler": "cosine",
      "scheduler_params": {
        "T_max": 2
      },
      "optimizer": "adam",
      "momentum": 0.9,
      "eval_every": 5,
      "save_checkpoints": true,
      "checkpoint_dir": "./checkpoints",
      "tversky": {
        "num_prototypes": 8,
        "alpha": 0.5,
        "beta": 0.5,
        "theta": 1e-07,
        "intersection_reduction": "product",
        "difference_reduction": "subtractmatch",
        "feature_bank_init": "xavier",
        "prototype_init": "xavier",
        "temperature": 1.0
      },
      "device": "auto",
      "mixed_precision": true
    }
  },
  "args": {
    "model_type": "resnet",
    "preset": "resnet_mnist_quick",
    "experiment_name": null,
    "epochs": 50,
    "lr": 0.01,
    "batch_size": 64,
    "optimizer": "adam",
    "scheduler": "cosine",
    "seed": 42,
    "prototypes": 8,
    "alpha": 0.5,
    "beta": 0.5,
    "xor_samples": 1000,
    "xor_hidden_dim": 8,
    "xor_noise": 0.1,
    "no_plots": false,
    "architecture": "resnet18",
    "dataset": "mnist",
    "pretrained": true,
    "frozen": false,
    "use_tversky": true,
    "data_dir": "./data",
    "checkpoint_dir": "./checkpoints",
    "results_dir": "./results",
    "device": "auto",
    "table1": false,
    "dry_run": false
  },
  "results": {
    "config": {
      "experiment_name": "tversky_resnet_mnist",
      "run_name": "resnet18_mnist_tversky_pretrained_unfrozen",
      "architecture": "resnet18",
      "pretrained": true,
      "frozen": false,
      "use_tversky": true,
      "dataset": "mnist",
      "data_dir": "./data",
      "batch_size": 64,
      "num_workers": 4,
      "epochs": 2,
      "learning_rate": 0.01,
      "weight_decay": 0.0001,
      "scheduler": "cosine",
      "scheduler_params": {
        "T_max": 2
      },
      "optimizer": "adam",
      "momentum": 0.9,
      "eval_every": 5,
      "save_checkpoints": true,
      "checkpoint_dir": "./checkpoints",
      "tversky": {
        "num_prototypes": 8,
        "alpha": 0.5,
        "beta": 0.5,
        "theta": 1e-07,
        "intersection_reduction": "product",
        "difference_reduction": "subtractmatch",
        "feature_bank_init": "xavier",
        "prototype_init": "xavier",
        "temperature": 1.0
      },
      "device": "auto",
      "mixed_precision": true
    },
    "metrics": {
      "epoch": [
        0,
        1
      ],
      "train_accuracy": [
        0.8600185185185185,
        0.9866481481481482
      ],
      "train_loss": [
        0.460035890905778,
        0.0732799262797098
      ],
      "train_num_samples": [
        54000,
        54000
      ],
      "train_class_0_acc": [
        0.799625468164794,
        0.9915730337078652
      ],
      "train_class_1_acc": [
        0.9743252139565504,
        0.9888084265964451
      ],
      "train_class_2_acc": [
        0.8476685862901727,
        0.9877391788965261
      ],
      "train_class_3_acc": [
        0.8976220729715012,
        0.9887456888727537
      ],
      "train_class_4_acc": [
        0.9126953869614944,
        0.9860846359130766
      ],
      "train_class_5_acc": [
        0.7544360595553743,
        0.9834795023455027
      ],
      "train_class_6_acc": [
        0.7825923134890731,
        0.9890730972117558
      ],
      "train_class_7_acc": [
        0.9242289178106614,
        0.9859154929577465
      ],
      "train_class_8_acc": [
        0.8178530643319376,
        0.9826798629615531
      ],
      "train_class_9_acc": [
        0.8602010424422933,
        0.9817572598659717
      ],
      "train_class_0_precision": [
        0.7684002159438545,
        0.9928745546596662
      ],
      "train_class_0_recall": [
        0.799625468164794,
        0.9915730337078652
      ],
      "train_class_0_f1": [
        0.7837019363127466,
        0.9922233673756208
      ],
      "train_class_1_precision": [
        0.9068627450980392,
        0.9938792390405293
      ],
      "train_class_1_recall": [
        0.9743252139565504,
        0.9888084265964451
      ],
      "train_class_1_f1": [
        0.9393843224373214,
        0.9913373484035971
      ],
      "train_class_2_precision": [
        0.8411059907834101,
        0.9788291605301914
      ],
      "train_class_2_recall": [
        0.8476685862901727,
        0.9877391788965261
      ],
      "train_class_2_f1": [
        0.8443745373797188,
        0.9832639852057327
      ],
      "train_class_3_precision": [
        0.8276150627615063,
        0.9925291545189504
      ],
      "train_class_3_recall": [
        0.8976220729715012,
        0.9887456888727537
      ],
      "train_class_3_f1": [
        0.8611981887843957,
        0.9906338092206967
      ],
      "train_class_4_precision": [
        0.9075056861258529,
        0.9864607170099161
      ],
      "train_class_4_recall": [
        0.9126953869614944,
        0.9860846359130766
      ],
      "train_class_4_f1": [
        0.9100931381866566,
        0.9862726406101048
      ],
      "train_class_5_precision": [
        0.9312688821752266,
        0.9866994065889093
      ],
      "train_class_5_recall": [
        0.7544360595553743,
        0.9834795023455027
      ],
      "train_class_5_f1": [
        0.8335774647887324,
        0.9850868232890705
      ],
      "train_class_6_precision": [
        0.8235527359238699,
        0.985545335085414
      ],
      "train_class_6_recall": [
        0.7825923134890731,
        0.9890730972117558
      ],
      "train_class_6_f1": [
        0.802550231839258,
        0.9873060648801129
      ],
      "train_class_7_precision": [
        0.8752321458720244,
        0.9827616847343167
      ],
      "train_class_7_recall": [
        0.9242289178106614,
        0.9859154929577465
      ],
      "train_class_7_f1": [
        0.899063475546306,
        0.9843360626557494
      ],
      "train_class_8_precision": [
        0.8918638439186385,
        0.9847415601754721
      ],
      "train_class_8_recall": [
        0.8178530643319376,
        0.9826798629615531
      ],
      "train_class_8_f1": [
        0.8532565528196981,
        0.9837096313232352
      ],
      "train_class_9_precision": [
        0.8429405326523167,
        0.9813918868626721
      ],
      "train_class_9_recall": [
        0.8602010424422933,
        0.9817572598659717
      ],
      "train_class_9_f1": [
        0.85148332412014,
        0.981574539363484
      ],
      "train_macro_precision": [
        0.861634784125474,
        0.9865712699206037
      ],
      "train_macro_recall": [
        0.8571248125973853,
        0.9865856179329198
      ],
      "train_macro_f1": [
        0.8578683172214975,
        0.9865744272327405
      ],
      "val_accuracy": [
        0.9905
      ],
      "val_loss": [
        0.05524350185581344
      ],
      "val_num_samples": [
        6000
      ],
      "val_class_0_acc": [
        0.9982847341337907
      ],
      "val_class_1_acc": [
        0.9984984984984985
      ],
      "val_class_2_acc": [
        0.991304347826087
      ],
      "val_class_3_acc": [
        0.9951768488745981
      ],
      "val_class_4_acc": [
        0.9916107382550335
      ],
      "val_class_5_acc": [
        0.974903474903475
      ],
      "val_class_6_acc": [
        0.9950819672131147
      ],
      "val_class_7_acc": [
        0.9832317073170732
      ],
      "val_class_8_acc": [
        0.9899497487437185
      ],
      "val_class_9_acc": [
        0.9844020797227037
      ],
      "val_class_0_precision": [
        0.9931740614334471
      ],
      "val_class_0_recall": [
        0.9982847341337907
      ],
      "val_class_0_f1": [
        0.9957228400342173
      ],
      "val_class_1_precision": [
        0.9895833333333334
      ],
      "val_class_1_recall": [
        0.9984984984984985
      ],
      "val_class_1_f1": [
        0.9940209267563528
      ],
      "val_class_2_precision": [
        0.979381443298969
      ],
      "val_class_2_recall": [
        0.991304347826087
      ],
      "val_class_2_f1": [
        0.9853068280034571
      ],
      "val_class_3_precision": [
        0.9935794542536116
      ],
      "val_class_3_recall": [
        0.9951768488745981
      ],
      "val_class_3_f1": [
        0.9943775100401607
      ],
      "val_class_4_precision": [
        0.9833610648918469
      ],
      "val_class_4_recall": [
        0.9916107382550335
      ],
      "val_class_4_f1": [
        0.9874686716791979
      ],
      "val_class_5_precision": [
        0.9980237154150198
      ],
      "val_class_5_recall": [
        0.974903474903475
      ],
      "val_class_5_f1": [
        0.9863281250000001
      ],
      "val_class_6_precision": [
        0.9853896103896104
      ],
      "val_class_6_recall": [
        0.9950819672131147
      ],
      "val_class_6_f1": [
        0.9902120717781402
      ],
      "val_class_7_precision": [
        0.9984520123839009
      ],
      "val_class_7_recall": [
        0.9832317073170732
      ],
      "val_class_7_f1": [
        0.9907834101382489
      ],
      "val_class_8_precision": [
        1.0
      ],
      "val_class_8_recall": [
        0.9899497487437185
      ],
      "val_class_8_f1": [
        0.9949494949494949
      ],
      "val_class_9_precision": [
        0.9844020797227037
      ],
      "val_class_9_recall": [
        0.9844020797227037
      ],
      "val_class_9_f1": [
        0.9844020797227037
      ],
      "val_macro_precision": [
        0.9905346775122444
      ],
      "val_macro_recall": [
        0.9902444145488094
      ],
      "val_macro_f1": [
        0.9903571958101974
      ]
    },
    "best_val_accuracy": 0.9905,
    "final_results": {
      "validation": {
        "accuracy": 0.9905,
        "loss": 0.05524350185581344,
        "num_samples": 6000,
        "class_0_acc": 0.9982847341337907,
        "class_1_acc": 0.9984984984984985,
        "class_2_acc": 0.991304347826087,
        "class_3_acc": 0.9951768488745981,
        "class_4_acc": 0.9916107382550335,
        "class_5_acc": 0.974903474903475,
        "class_6_acc": 0.9950819672131147,
        "class_7_acc": 0.9832317073170732,
        "class_8_acc": 0.9899497487437185,
        "class_9_acc": 0.9844020797227037,
        "class_0_precision": 0.9931740614334471,
        "class_0_recall": 0.9982847341337907,
        "class_0_f1": 0.9957228400342173,
        "class_1_precision": 0.9895833333333334,
        "class_1_recall": 0.9984984984984985,
        "class_1_f1": 0.9940209267563528,
        "class_2_precision": 0.979381443298969,
        "class_2_recall": 0.991304347826087,
        "class_2_f1": 0.9853068280034571,
        "class_3_precision": 0.9935794542536116,
        "class_3_recall": 0.9951768488745981,
        "class_3_f1": 0.9943775100401607,
        "class_4_precision": 0.9833610648918469,
        "class_4_recall": 0.9916107382550335,
        "class_4_f1": 0.9874686716791979,
        "class_5_precision": 0.9980237154150198,
        "class_5_recall": 0.974903474903475,
        "class_5_f1": 0.9863281250000001,
        "class_6_precision": 0.9853896103896104,
        "class_6_recall": 0.9950819672131147,
        "class_6_f1": 0.9902120717781402,
        "class_7_precision": 0.9984520123839009,
        "class_7_recall": 0.9832317073170732,
        "class_7_f1": 0.9907834101382489,
        "class_8_precision": 1.0,
        "class_8_recall": 0.9899497487437185,
        "class_8_f1": 0.9949494949494949,
        "class_9_precision": 0.9844020797227037,
        "class_9_recall": 0.9844020797227037,
        "class_9_f1": 0.9844020797227037,
        "macro_precision": 0.9905346775122444,
        "macro_recall": 0.9902444145488094,
        "macro_f1": 0.9903571958101974
      },
      "test": {
        "accuracy": 0.9912,
        "loss": 0.049201821825306885,
        "num_samples": 10000,
        "class_0_acc": 0.9979591836734694,
        "class_1_acc": 0.9955947136563876,
        "class_2_acc": 0.998062015503876,
        "class_3_acc": 0.994059405940594,
        "class_4_acc": 0.9938900203665988,
        "class_5_acc": 0.9798206278026906,
        "class_6_acc": 0.9958246346555324,
        "class_7_acc": 0.9824902723735408,
        "class_8_acc": 0.9938398357289527,
        "class_9_acc": 0.979187314172448,
        "class_0_precision": 0.9989785495403473,
        "class_0_recall": 0.9979591836734694,
        "class_0_f1": 0.998468606431853,
        "class_1_precision": 0.9920983318700615,
        "class_1_recall": 0.9955947136563876,
        "class_1_f1": 0.9938434476693052,
        "class_2_precision": 0.982824427480916,
        "class_2_recall": 0.998062015503876,
        "class_2_f1": 0.9903846153846154,
        "class_3_precision": 0.9891625615763546,
        "class_3_recall": 0.994059405940594,
        "class_3_f1": 0.9916049382716049,
        "class_4_precision": 0.9809045226130654,
        "class_4_recall": 0.9938900203665988,
        "class_4_f1": 0.9873545776428934,
        "class_5_precision": 0.9988571428571429,
        "class_5_recall": 0.9798206278026906,
        "class_5_f1": 0.989247311827957,
        "class_6_precision": 0.9927159209157128,
        "class_6_recall": 0.9958246346555324,
        "class_6_f1": 0.9942678478374154,
        "class_7_precision": 0.9901960784313726,
        "class_7_recall": 0.9824902723735408,
        "class_7_f1": 0.9863281249999999,
        "class_8_precision": 0.9948612538540597,
        "class_8_recall": 0.9938398357289527,
        "class_8_f1": 0.9943502824858756,
        "class_9_precision": 0.992964824120603,
        "class_9_recall": 0.979187314172448,
        "class_9_f1": 0.9860279441117764,
        "macro_precision": 0.9913563613259635,
        "macro_recall": 0.9910728023874089,
        "macro_f1": 0.9911877696663296
      }
    },
    "training_time": 1902.9396228790283
  }
}