{
  "timestamp": "20250815_224144",
  "args": {
    "architecture": "resnet18",
    "pretrained": true,
    "frozen": false,
    "use_tversky": true,
    "dataset": "mnist",
    "data_dir": "./data",
    "batch_size": 64,
    "epochs": 2,
    "lr": 0.01,
    "optimizer": "adam",
    "scheduler": "cosine",
    "num_prototypes": 8,
    "alpha": 0.5,
    "beta": 0.5,
    "experiment_name": "tversky_resnet",
    "checkpoint_dir": "./checkpoints",
    "results_dir": "./results",
    "device": "auto",
    "quick": false,
    "table1": false
  },
  "results": {
    "config": {
      "experiment_name": "tversky_resnet",
      "run_name": "resnet18_mnist_tversky_pretrained_unfrozen",
      "architecture": "resnet18",
      "pretrained": true,
      "frozen": false,
      "use_tversky": true,
      "dataset": "mnist",
      "data_dir": "./data",
      "batch_size": 64,
      "num_workers": 4,
      "epochs": 2,
      "learning_rate": 0.01,
      "weight_decay": 0.0001,
      "scheduler": "cosine",
      "scheduler_params": {
        "T_max": 2
      },
      "optimizer": "adam",
      "momentum": 0.9,
      "eval_every": 5,
      "save_checkpoints": true,
      "checkpoint_dir": "./checkpoints",
      "tversky": {
        "num_prototypes": 8,
        "alpha": 0.5,
        "beta": 0.5,
        "theta": 1e-07,
        "intersection_reduction": "product",
        "difference_reduction": "subtractmatch",
        "feature_bank_init": "xavier",
        "prototype_init": "xavier",
        "temperature": 1.0
      },
      "device": "auto",
      "mixed_precision": true
    },
    "metrics": {
      "epoch": [
        0,
        1
      ],
      "train_accuracy": [
        0.8981111111111111,
        0.9881111111111112
      ],
      "train_loss": [
        0.38395600956621895,
        0.06911922615215677
      ],
      "train_num_samples": [
        54000,
        54000
      ],
      "train_class_0_acc": [
        0.9338951310861423,
        0.9923220973782771
      ],
      "train_class_1_acc": [
        0.9035549703752469,
        0.990125082290981
      ],
      "train_class_2_acc": [
        0.9225339030280513,
        0.9851383986624559
      ],
      "train_class_3_acc": [
        0.9077872572154656,
        0.9923761118170267
      ],
      "train_class_4_acc": [
        0.793175752954632,
        0.9864658787647732
      ],
      "train_class_5_acc": [
        0.8802773811951866,
        0.988374464613502
      ],
      "train_class_6_acc": [
        0.8673700075357951,
        0.9886963074604371
      ],
      "train_class_7_acc": [
        0.9272597610982349,
        0.9880549117489749
      ],
      "train_class_8_acc": [
        0.9379520365435858,
        0.9853444994290065
      ],
      "train_class_9_acc": [
        0.9017125837676843,
        0.9838049143708116
      ],
      "train_class_0_precision": [
        0.9443287256201477,
        0.9934383202099738
      ],
      "train_class_0_recall": [
        0.9338951310861423,
        0.9923220973782771
      ],
      "train_class_0_f1": [
        0.9390829488748705,
        0.9928798950721379
      ],
      "train_class_1_precision": [
        0.8507670850767085,
        0.988173455978975
      ],
      "train_class_1_recall": [
        0.9035549703752469,
        0.990125082290981
      ],
      "train_class_1_f1": [
        0.8763668289568202,
        0.9891483064781322
      ],
      "train_class_2_precision": [
        0.8651567944250871,
        0.9882594111069698
      ],
      "train_class_2_recall": [
        0.9225339030280513,
        0.9851383986624559
      ],
      "train_class_2_f1": [
        0.8929245707093411,
        0.9866964368778492
      ],
      "train_class_3_precision": [
        0.8999460140363506,
        0.9921960072595282
      ],
      "train_class_3_recall": [
        0.9077872572154656,
        0.9923761118170267
      ],
      "train_class_3_f1": [
        0.9038496294957528,
        0.9922860513658227
      ],
      "train_class_4_precision": [
        0.8656126482213439,
        0.9849638370765131
      ],
      "train_class_4_recall": [
        0.793175752954632,
        0.9864658787647732
      ],
      "train_class_4_f1": [
        0.8278125932557445,
        0.9857142857142858
      ],
      "train_class_5_precision": [
        0.9111251847160651,
        0.9877700774561761
      ],
      "train_class_5_recall": [
        0.8802773811951866,
        0.988374464613502
      ],
      "train_class_5_f1": [
        0.8954356846473029,
        0.9880721786114791
      ],
      "train_class_6_precision": [
        0.9235707121364092,
        0.9907494808382104
      ],
      "train_class_6_recall": [
        0.8673700075357951,
        0.9886963074604371
      ],
      "train_class_6_f1": [
        0.8945885553288642,
        0.9897218293257899
      ],
      "train_class_7_precision": [
        0.912136092599088,
        0.987350792802423
      ],
      "train_class_7_recall": [
        0.9272597610982349,
        0.9880549117489749
      ],
      "train_class_7_f1": [
        0.9196357528070019,
        0.987702726786669
      ],
      "train_class_8_precision": [
        0.9268384427308632,
        0.9859074462007237
      ],
      "train_class_8_recall": [
        0.9379520365435858,
        0.9853444994290065
      ],
      "train_class_8_f1": [
        0.9323621227887616,
        0.9856258924321751
      ],
      "train_class_9_precision": [
        0.8935620734181885,
        0.9821594499163724
      ],
      "train_class_9_recall": [
        0.9017125837676843,
        0.9838049143708116
      ],
      "train_class_9_f1": [
        0.8976188270175112,
        0.9829814935366875
      ],
      "train_macro_precision": [
        0.8993043772980253,
        0.9880968278845865
      ],
      "train_macro_recall": [
        0.8975518784800025,
        0.9880702666536246
      ],
      "train_macro_f1": [
        0.8979677513881972,
        0.9880829096201028
      ],
      "val_accuracy": [
        0.9888333333333333
      ],
      "val_loss": [
        0.06624425810940088
      ],
      "val_num_samples": [
        6000
      ],
      "val_class_0_acc": [
        0.9982847341337907
      ],
      "val_class_1_acc": [
        0.9984984984984985
      ],
      "val_class_2_acc": [
        0.9895652173913043
      ],
      "val_class_3_acc": [
        0.9951768488745981
      ],
      "val_class_4_acc": [
        0.9949664429530202
      ],
      "val_class_5_acc": [
        0.9864864864864865
      ],
      "val_class_6_acc": [
        0.9721311475409836
      ],
      "val_class_7_acc": [
        0.9969512195121951
      ],
      "val_class_8_acc": [
        0.9865996649916248
      ],
      "val_class_9_acc": [
        0.9670710571923743
      ],
      "val_class_0_precision": [
        0.9982847341337907
      ],
      "val_class_0_recall": [
        0.9982847341337907
      ],
      "val_class_0_f1": [
        0.9982847341337907
      ],
      "val_class_1_precision": [
        0.9910581222056631
      ],
      "val_class_1_recall": [
        0.9984984984984985
      ],
      "val_class_1_f1": [
        0.9947643979057591
      ],
      "val_class_2_precision": [
        0.9895652173913043
      ],
      "val_class_2_recall": [
        0.9895652173913043
      ],
      "val_class_2_f1": [
        0.9895652173913043
      ],
      "val_class_3_precision": [
        0.9967793880837359
      ],
      "val_class_3_recall": [
        0.9951768488745981
      ],
      "val_class_3_f1": [
        0.9959774738535802
      ],
      "val_class_4_precision": [
        0.967373572593801
      ],
      "val_class_4_recall": [
        0.9949664429530202
      ],
      "val_class_4_f1": [
        0.9809760132340777
      ],
      "val_class_5_precision": [
        0.9751908396946565
      ],
      "val_class_5_recall": [
        0.9864864864864865
      ],
      "val_class_5_f1": [
        0.9808061420345491
      ],
      "val_class_6_precision": [
        0.9966386554621849
      ],
      "val_class_6_recall": [
        0.9721311475409836
      ],
      "val_class_6_f1": [
        0.9842323651452283
      ],
      "val_class_7_precision": [
        0.9864253393665159
      ],
      "val_class_7_recall": [
        0.9969512195121951
      ],
      "val_class_7_f1": [
        0.9916603487490522
      ],
      "val_class_8_precision": [
        0.9949324324324325
      ],
      "val_class_8_recall": [
        0.9865996649916248
      ],
      "val_class_8_f1": [
        0.9907485281749369
      ],
      "val_class_9_precision": [
        0.9911190053285968
      ],
      "val_class_9_recall": [
        0.9670710571923743
      ],
      "val_class_9_f1": [
        0.9789473684210526
      ],
      "val_macro_precision": [
        0.9887367306692683
      ],
      "val_macro_recall": [
        0.9885731317574876
      ],
      "val_macro_f1": [
        0.9885962589043331
      ]
    },
    "best_val_accuracy": 0.9888333333333333,
    "final_results": {
      "validation": {
        "accuracy": 0.9888333333333333,
        "loss": 0.06624425810940088,
        "num_samples": 6000,
        "class_0_acc": 0.9982847341337907,
        "class_1_acc": 0.9984984984984985,
        "class_2_acc": 0.9895652173913043,
        "class_3_acc": 0.9951768488745981,
        "class_4_acc": 0.9949664429530202,
        "class_5_acc": 0.9864864864864865,
        "class_6_acc": 0.9721311475409836,
        "class_7_acc": 0.9969512195121951,
        "class_8_acc": 0.9865996649916248,
        "class_9_acc": 0.9670710571923743,
        "class_0_precision": 0.9982847341337907,
        "class_0_recall": 0.9982847341337907,
        "class_0_f1": 0.9982847341337907,
        "class_1_precision": 0.9910581222056631,
        "class_1_recall": 0.9984984984984985,
        "class_1_f1": 0.9947643979057591,
        "class_2_precision": 0.9895652173913043,
        "class_2_recall": 0.9895652173913043,
        "class_2_f1": 0.9895652173913043,
        "class_3_precision": 0.9967793880837359,
        "class_3_recall": 0.9951768488745981,
        "class_3_f1": 0.9959774738535802,
        "class_4_precision": 0.967373572593801,
        "class_4_recall": 0.9949664429530202,
        "class_4_f1": 0.9809760132340777,
        "class_5_precision": 0.9751908396946565,
        "class_5_recall": 0.9864864864864865,
        "class_5_f1": 0.9808061420345491,
        "class_6_precision": 0.9966386554621849,
        "class_6_recall": 0.9721311475409836,
        "class_6_f1": 0.9842323651452283,
        "class_7_precision": 0.9864253393665159,
        "class_7_recall": 0.9969512195121951,
        "class_7_f1": 0.9916603487490522,
        "class_8_precision": 0.9949324324324325,
        "class_8_recall": 0.9865996649916248,
        "class_8_f1": 0.9907485281749369,
        "class_9_precision": 0.9911190053285968,
        "class_9_recall": 0.9670710571923743,
        "class_9_f1": 0.9789473684210526,
        "macro_precision": 0.9887367306692683,
        "macro_recall": 0.9885731317574876,
        "macro_f1": 0.9885962589043331
      },
      "test": {
        "accuracy": 0.9899,
        "loss": 0.05705388564213067,
        "num_samples": 10000,
        "class_0_acc": 0.9938775510204082,
        "class_1_acc": 0.9982378854625551,
        "class_2_acc": 0.9922480620155039,
        "class_3_acc": 0.9930693069306931,
        "class_4_acc": 0.9969450101832994,
        "class_5_acc": 0.9876681614349776,
        "class_6_acc": 0.9780793319415448,
        "class_7_acc": 0.9961089494163424,
        "class_8_acc": 0.9887063655030801,
        "class_9_acc": 0.9722497522299306,
        "class_0_precision": 0.9948927477017364,
        "class_0_recall": 0.9938775510204082,
        "class_0_f1": 0.9943848902501277,
        "class_1_precision": 0.9895196506550218,
        "class_1_recall": 0.9982378854625551,
        "class_1_f1": 0.993859649122807,
        "class_2_precision": 0.9893719806763285,
        "class_2_recall": 0.9922480620155039,
        "class_2_f1": 0.9908079342041607,
        "class_3_precision": 0.9881773399014778,
        "class_3_recall": 0.9930693069306931,
        "class_3_f1": 0.9906172839506172,
        "class_4_precision": 0.9702675916749257,
        "class_4_recall": 0.9969450101832994,
        "class_4_f1": 0.983425414364641,
        "class_5_precision": 0.9887766554433222,
        "class_5_recall": 0.9876681614349776,
        "class_5_f1": 0.9882220975883342,
        "class_6_precision": 0.9989339019189766,
        "class_6_recall": 0.9780793319415448,
        "class_6_f1": 0.9883966244725738,
        "class_7_precision": 0.9893719806763285,
        "class_7_recall": 0.9961089494163424,
        "class_7_f1": 0.9927290353853612,
        "class_8_precision": 0.9968944099378882,
        "class_8_recall": 0.9887063655030801,
        "class_8_f1": 0.9927835051546392,
        "class_9_precision": 0.993920972644377,
        "class_9_recall": 0.9722497522299306,
        "class_9_f1": 0.9829659318637274,
        "macro_precision": 0.9900127231230383,
        "macro_recall": 0.9897190376138336,
        "macro_f1": 0.9898192366356989
      }
    },
    "training_time": 1941.239406824112
  }
}