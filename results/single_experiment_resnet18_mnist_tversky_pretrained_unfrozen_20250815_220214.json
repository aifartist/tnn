{
  "timestamp": "20250815_220214",
  "args": {
    "architecture": "resnet18",
    "pretrained": true,
    "frozen": false,
    "use_tversky": true,
    "dataset": "mnist",
    "data_dir": "./data",
    "batch_size": 64,
    "epochs": 2,
    "lr": 0.001,
    "optimizer": "adam",
    "scheduler": "cosine",
    "num_prototypes": 8,
    "alpha": 0.5,
    "beta": 0.5,
    "experiment_name": "tversky_resnet",
    "checkpoint_dir": "./checkpoints",
    "results_dir": "./results",
    "device": "auto",
    "quick": false,
    "table1": false
  },
  "results": {
    "config": {
      "experiment_name": "tversky_resnet",
      "run_name": "resnet18_mnist_tversky_pretrained_unfrozen",
      "architecture": "resnet18",
      "pretrained": true,
      "frozen": false,
      "use_tversky": true,
      "dataset": "mnist",
      "data_dir": "./data",
      "batch_size": 64,
      "num_workers": 4,
      "epochs": 2,
      "learning_rate": 0.001,
      "weight_decay": 0.0001,
      "scheduler": "cosine",
      "scheduler_params": {
        "T_max": 2
      },
      "optimizer": "adam",
      "momentum": 0.9,
      "eval_every": 5,
      "save_checkpoints": true,
      "checkpoint_dir": "./checkpoints",
      "tversky": {
        "num_prototypes": 8,
        "alpha": 0.5,
        "beta": 0.5,
        "theta": 1e-07,
        "intersection_reduction": "product",
        "difference_reduction": "subtractmatch",
        "feature_bank_init": "xavier",
        "prototype_init": "xavier",
        "temperature": 1.0
      },
      "device": "auto",
      "mixed_precision": true
    },
    "metrics": {
      "epoch": [
        0,
        1
      ],
      "train_accuracy": [
        0.2738333333333333,
        0.3101111111111111
      ],
      "train_loss": [
        2.116955303609089,
        1.8538490704733048
      ],
      "train_num_samples": [
        54000,
        54000
      ],
      "train_class_0_acc": [
        0.3080524344569288,
        0.011797752808988765
      ],
      "train_class_1_acc": [
        0.8895655036208031,
        0.9927583936800527
      ],
      "train_class_2_acc": [
        0.43600222924020066,
        0.9511424856028237
      ],
      "train_class_3_acc": [
        0.6512978762025776,
        0.9829370121619169
      ],
      "train_class_4_acc": [
        0.096263820053374,
        0.0
      ],
      "train_class_5_acc": [
        0.0,
        0.0
      ],
      "train_class_6_acc": [
        0.0009419743782969103,
        0.00018839487565938207
      ],
      "train_class_7_acc": [
        0.0,
        0.0
      ],
      "train_class_8_acc": [
        0.11515036162923487,
        0.02131709173962695
      ],
      "train_class_9_acc": [
        0.12788533134772898,
        0.0005584512285927029
      ],
      "train_class_0_precision": [
        0.1377952755905512,
        0.7159090909090909
      ],
      "train_class_0_recall": [
        0.3080524344569288,
        0.011797752808988765
      ],
      "train_class_0_f1": [
        0.19041555735617546,
        0.023212969786293294
      ],
      "train_class_1_precision": [
        0.3854931887882462,
        0.36376794114099625
      ],
      "train_class_1_recall": [
        0.8895655036208031,
        0.9927583936800527
      ],
      "train_class_1_f1": [
        0.5378912275464,
        0.5324388736869979
      ],
      "train_class_2_precision": [
        0.3187126561651277,
        0.32768
      ],
      "train_class_2_recall": [
        0.43600222924020066,
        0.9511424856028237
      ],
      "train_class_2_f1": [
        0.36824350827645724,
        0.4874333587204875
      ],
      "train_class_3_precision": [
        0.2508740036358551,
        0.2544762441844072
      ],
      "train_class_3_recall": [
        0.6512978762025776,
        0.9829370121619169
      ],
      "train_class_3_f1": [
        0.36222300742012015,
        0.4042855009705838
      ],
      "train_class_4_precision": [
        0.3136645962732919,
        0.0
      ],
      "train_class_4_recall": [
        0.096263820053374,
        0.0
      ],
      "train_class_4_f1": [
        0.147316219369895,
        0.0
      ],
      "train_class_5_precision": [
        0.0,
        0.0
      ],
      "train_class_5_recall": [
        0.0,
        0.0
      ],
      "train_class_5_f1": [
        0.0,
        0.0
      ],
      "train_class_6_precision": [
        0.29411764705882354,
        0.5
      ],
      "train_class_6_recall": [
        0.0009419743782969103,
        0.00018839487565938207
      ],
      "train_class_6_f1": [
        0.0018779342723004697,
        0.0003766478342749529
      ],
      "train_class_7_precision": [
        0.0,
        0.0
      ],
      "train_class_7_recall": [
        0.0,
        0.0
      ],
      "train_class_7_f1": [
        0.0,
        0.0
      ],
      "train_class_8_precision": [
        0.316257187663356,
        0.28211586901763225
      ],
      "train_class_8_recall": [
        0.11515036162923487,
        0.02131709173962695
      ],
      "train_class_8_f1": [
        0.16882935677410352,
        0.03963900194655813
      ],
      "train_class_9_precision": [
        0.24232804232804234,
        0.11538461538461539
      ],
      "train_class_9_recall": [
        0.12788533134772898,
        0.0005584512285927029
      ],
      "train_class_9_f1": [
        0.16741805775557453,
        0.0011115227862171174
      ],
      "train_macro_precision": [
        0.2259242597503294,
        0.2559333760636742
      ],
      "train_macro_recall": [
        0.2625159530929145,
        0.2960699582097661
      ],
      "train_macro_f1": [
        0.19442148687710264,
        0.1488497875731413
      ],
      "val_accuracy": [
        0.30833333333333335
      ],
      "val_loss": [
        1.7884166532374444
      ],
      "val_num_samples": [
        6000
      ],
      "val_class_0_acc": [
        0.012006861063464836
      ],
      "val_class_1_acc": [
        0.9924924924924925
      ],
      "val_class_2_acc": [
        0.9756521739130435
      ],
      "val_class_3_acc": [
        0.9967845659163987
      ],
      "val_class_4_acc": [
        0.0
      ],
      "val_class_5_acc": [
        0.0
      ],
      "val_class_6_acc": [
        0.0
      ],
      "val_class_7_acc": [
        0.0
      ],
      "val_class_8_acc": [
        0.0
      ],
      "val_class_9_acc": [
        0.0017331022530329288
      ],
      "val_class_0_precision": [
        1.0
      ],
      "val_class_0_recall": [
        0.012006861063464836
      ],
      "val_class_0_f1": [
        0.02372881355932203
      ],
      "val_class_1_precision": [
        0.3553763440860215
      ],
      "val_class_1_recall": [
        0.9924924924924925
      ],
      "val_class_1_f1": [
        0.5233570863024545
      ],
      "val_class_2_precision": [
        0.3189312109152928
      ],
      "val_class_2_recall": [
        0.9756521739130435
      ],
      "val_class_2_f1": [
        0.480719794344473
      ],
      "val_class_3_precision": [
        0.26171380329252847
      ],
      "val_class_3_recall": [
        0.9967845659163987
      ],
      "val_class_3_f1": [
        0.414577064526914
      ],
      "val_class_4_precision": [
        0.0
      ],
      "val_class_4_recall": [
        0.0
      ],
      "val_class_4_f1": [
        0.0
      ],
      "val_class_5_precision": [
        0.0
      ],
      "val_class_5_recall": [
        0.0
      ],
      "val_class_5_f1": [
        0.0
      ],
      "val_class_6_precision": [
        0.0
      ],
      "val_class_6_recall": [
        0.0
      ],
      "val_class_6_f1": [
        0.0
      ],
      "val_class_7_precision": [
        0.0
      ],
      "val_class_7_recall": [
        0.0
      ],
      "val_class_7_f1": [
        0.0
      ],
      "val_class_8_precision": [
        0.0
      ],
      "val_class_8_recall": [
        0.0
      ],
      "val_class_8_f1": [
        0.0
      ],
      "val_class_9_precision": [
        0.2
      ],
      "val_class_9_recall": [
        0.0017331022530329288
      ],
      "val_class_9_f1": [
        0.003436426116838488
      ],
      "val_macro_precision": [
        0.2136021358293843
      ],
      "val_macro_recall": [
        0.29786691956384326
      ],
      "val_macro_f1": [
        0.14458191848500018
      ]
    },
    "best_val_accuracy": 0.30833333333333335,
    "final_results": {
      "validation": {
        "accuracy": 0.30833333333333335,
        "loss": 1.7884166532374444,
        "num_samples": 6000,
        "class_0_acc": 0.012006861063464836,
        "class_1_acc": 0.9924924924924925,
        "class_2_acc": 0.9756521739130435,
        "class_3_acc": 0.9967845659163987,
        "class_4_acc": 0.0,
        "class_5_acc": 0.0,
        "class_6_acc": 0.0,
        "class_7_acc": 0.0,
        "class_8_acc": 0.0,
        "class_9_acc": 0.0017331022530329288,
        "class_0_precision": 1.0,
        "class_0_recall": 0.012006861063464836,
        "class_0_f1": 0.02372881355932203,
        "class_1_precision": 0.3553763440860215,
        "class_1_recall": 0.9924924924924925,
        "class_1_f1": 0.5233570863024545,
        "class_2_precision": 0.3189312109152928,
        "class_2_recall": 0.9756521739130435,
        "class_2_f1": 0.480719794344473,
        "class_3_precision": 0.26171380329252847,
        "class_3_recall": 0.9967845659163987,
        "class_3_f1": 0.414577064526914,
        "class_4_precision": 0.0,
        "class_4_recall": 0.0,
        "class_4_f1": 0.0,
        "class_5_precision": 0.0,
        "class_5_recall": 0.0,
        "class_5_f1": 0.0,
        "class_6_precision": 0.0,
        "class_6_recall": 0.0,
        "class_6_f1": 0.0,
        "class_7_precision": 0.0,
        "class_7_recall": 0.0,
        "class_7_f1": 0.0,
        "class_8_precision": 0.0,
        "class_8_recall": 0.0,
        "class_8_f1": 0.0,
        "class_9_precision": 0.2,
        "class_9_recall": 0.0017331022530329288,
        "class_9_f1": 0.003436426116838488,
        "macro_precision": 0.2136021358293843,
        "macro_recall": 0.29786691956384326,
        "macro_f1": 0.14458191848500018
      },
      "test": {
        "accuracy": 0.3166,
        "loss": 1.789069108902269,
        "num_samples": 10000,
        "class_0_acc": 0.013265306122448979,
        "class_1_acc": 0.9885462555066079,
        "class_2_acc": 0.9883720930232558,
        "class_3_acc": 0.998019801980198,
        "class_4_acc": 0.0,
        "class_5_acc": 0.0,
        "class_6_acc": 0.0,
        "class_7_acc": 0.0,
        "class_8_acc": 0.0,
        "class_9_acc": 0.002973240832507433,
        "class_0_precision": 0.8125,
        "class_0_recall": 0.013265306122448979,
        "class_0_f1": 0.026104417670682726,
        "class_1_precision": 0.3689575797435054,
        "class_1_recall": 0.9885462555066079,
        "class_1_f1": 0.5373563218390803,
        "class_2_precision": 0.3425117528542646,
        "class_2_recall": 0.9883720930232558,
        "class_2_f1": 0.5087281795511222,
        "class_3_precision": 0.2549962054136099,
        "class_3_recall": 0.998019801980198,
        "class_3_f1": 0.40620592383638926,
        "class_4_precision": 0.0,
        "class_4_recall": 0.0,
        "class_4_f1": 0.0,
        "class_5_precision": 0.0,
        "class_5_recall": 0.0,
        "class_5_f1": 0.0,
        "class_6_precision": 0.0,
        "class_6_recall": 0.0,
        "class_6_f1": 0.0,
        "class_7_precision": 0.0,
        "class_7_recall": 0.0,
        "class_7_f1": 0.0,
        "class_8_precision": 0.0,
        "class_8_recall": 0.0,
        "class_8_f1": 0.0,
        "class_9_precision": 0.25,
        "class_9_recall": 0.002973240832507433,
        "class_9_f1": 0.005876591576885406,
        "macro_precision": 0.20289655380113797,
        "macro_recall": 0.29911766974650184,
        "macro_f1": 0.14842714344741598
      }
    },
    "training_time": 1900.5543241500854
  }
}